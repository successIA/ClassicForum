https://misago-project.org/a/thumb/6Zq1DdKNOClyhs5UjNIP3k3uuJG7tSRMPNedWjbwhArf1NW9B6VdGRRHmI0w9Mtk/363/?shva=1


thread -> comments
sender reciver comment THREAD_COMMENTED recent


Notification(sender, receiver)

thread -> 3 new comments (THREAD_COMMENTED)
thread -> 2 users liked your thread

NEW THREAD
REPLY COMMENTS

thread.thread_followers.filter(user=user)

for thread in thread_qs:
	thread.

picture mssage time hidden unread unfollow link reciver

Thread - User
UserThread

thread
 -> last_comment

enter threaddetail with notif 
	user_followership.last_comment = thread.comment_set('latest')
comment -> thread

	for thread_followership in comment.thread.thread_followership_set.all():
		if thread_followership.last_comment is thread.comments.latest('created'):
			thread_followership.last_comment = new_comment
			thread_followership.save()
		if thread_followership.thread.comments.count() == 1


thread.
threads = userprofile.thread_set.all()

    ThreadFollowership
		userprofile 
		thread
		last_comment

	@property
	def new_comments_count():
		if self.last_comment:
			return self.last_comment.get_new_comments_count()
		return None

Comment
	def get_precise_url(self):
			return self.thread.get_absolute_url() + '?read=True#comment=' + str(self.id)

Thread
	get_new_comments_count(self, last_comment=None):
		if not last_comment:
			raise Http404
		comments = self.comments.order_by('-created')
		new_comments_count = 0
		for comment in comments.all():
			if comment is last_comment:
				break
			new_comment_count =+ 1
		return new_comments_count



Thread Following Page
	thread_followership_set = userprofile.thread_followership_set.select_related('last_comment')

	for thread_fship in thread_followership_set.all():
		if thread_fship.new_comment_count:
			thread_fship.last_comment.get_precise_url thread_fship.new_comment_count
		else
			thread_fship.thread.absolute_url 
 

for tfhip in thead.thread_followership_set
	if 

Comment
 likers -> ManyToManyField UserProfile

UserLike
	user

comment.likers.count()

Notification(sender,receiver, message, unread)
meassage
You have got 10 new followers


UserLike
Comment.objects.likers.add()
CommentReaction
	user
	comment

thread in threads
 thread.title thread


UserThreadFollowership
user
thread


user1 thread1 unread_comment_id


for utf in thread.user_thread_followership_set:
	utf.unread_comment_id = self.id

thread in threads
 thread.get_absolute_url thread.title thread.use

a user will be link to the to comment where he stopped reading only if he clicked on the new page link
his comment time will only change if 
	he refresh the current page or drop a comment linking to the page
	 - there should be a link telling him the number of newly added comments plus indicator
	Just following a page

page = 2 per page = 5
select * from comments where thread_id = 1 and range(5,10)
comment.get_precise_url
	page no = posiotion/per_page
	get_precise_url = /categories/programming/python-programming-discussion-thread/?page=3

paginator = Paginator(comments, 5)

I created a thread
I remained on the page
9 comments with 3 pages were posted on the thread while I am staring at the thread body
I hit refresh
I should get an alert that there 9 new comments with the link to the first comment
and I should still remain on the page
 ----> No session time will be created since no comments
 ----> if the page is the first comment_time will not be updated
 ----> 
 ---->
 ---->
I created a thread
I left the page 
9 comments with 3 pages were posted on the thread while I am staring at the thread body
Someone gave me a link to the 2nd page of the thread I created
I opened the link, I should get an alert that there 9 new comments with the link to the first comment
and I should still remain on the page [ THE COMMENT TIME WILL NOT BE UPDATED UNLESS YOU ARE ON THE LAST PAGE AND WILL GET AND ALERT FOR NEW COMMENTS IF THERE IS NO SESSION ]

I created a thread
I left the page 
9 comments with 3 pages were posted on the thread while I am staring at the thread body
Someone gave me a link to the 3rd page of the thread I created
I opened the link, I should get an alert that there 9 new comments with the link to the first comment
and I should still remain on the page [ THE COMMENT TIME WILL NOT BE UPDATED UNLESS YOU ARE ON THE LAST PAGE AND WILL GET AND ALERT FOR NEW COMMENTS IF THERE IS NO SESSION]

I visited a thread I saw 6 comments with 2 pages I waited for some time.
 While I waiting 2 new comments were posted on the thread. Then I clicked 
on the follow button. Then I refresh I should get an alert that there 
2 new comments with the link to the first comment. If I did nt refresh instead
I left the page. I should still get an alert of 2 or more comments if I go to 
anywhere in the page [CHECK]

I visited a thread while I was crafting my reply 10 comments with four pages
poured in I should get an alert that there 10 new comments with the link to the first comment
and I should be redirected to the last page [CHECK]

and I should still remain on the page


the first comment_time should change if only if you on the last page of the thread
A session time should be created only

1 2 3 4 5 6

comment has many attachments
thread has manay attachments
userprofile has many attachments

Attachment
	image
	user
	comment
	thread
	userprofile


image
user

media/temp/user/images/abu.jpg
					   desert.jpg
					   chassandra.jpg

media/comments/images/
media/threads/images
media/userprofile/images

uploads/images/id/random_



